# Gestione di un club sportivo

L'applicativo Python realizzato, sia in REST che GraphQL, simula la gestione delle prenotazioni dei servizi di un club sportivo. È composto precisamente da due microservizi che comunicano sincronicamente tra di loro:  

- *member-service* per la gestione dei soci del club, solo loro possono usufruire delle risorse, è possibile effettuare nuove iscrizioni. Se un membro si disiscrive dal club allora tutte le sue prenotazioni da quel giorno in poi non saranno più valide.  
Gira sulle porte 5000:5000.

- *resource-service* per la gestione delle prenotazioni delle risorse, come i campi da calcio, tennis e beach volley per un limite di un'ora al giorno per tipologia dalle 10 alle 21, in più c'è anche la possibilità di prenotare lettini e/o ombrelloni nella piscina del club durante il periodo estivo (dal 20 maggio al 15 settembre di ogni anno). La struttura dispone di un totale di 20 ombrelloni e 80 lettini.   
Gira sulle porte 5001:5000.

Per la memorizzazione dei dati viene utilizzato SQLite e il file *.db* di ogni microservizio è salvato come volume all'interno dei container, non visibile in locale.

## REST

### *member-service*

Aggiunta di un membro
```bash
curl -X POST "http://localhost:5000/members" -H "Content-Type: application/json" -d "{"cf":"RSSMRA85M01H501Z", "name":"Mario", "surname":"Rossi"}"
```

Eliminazione di un membro e automatica cancellazione di tutte le sue prenotazioni
```bash
curl -X DELETE http://localhost:5000/members/RSSMRA85M01H501Z
```

Verifica dell'esistenza di un membro
```bash
curl -X GET http://localhost:5000/members/RSSMRA85M01H501Z
```

Elenco di tutti i membri
```bash
curl -X GET http://localhost:5000/members
```

### *resource-service*

Aggiunta di una prenotazione di un campo
```bash
curl -X POST "http://localhost:5001/resources/campo" -H "Content-Type: application/json" -d "{"cf":"RSSMRA85M01H501Z", "data":"2025-09-20", "ora":"10", "tipologia":"tennis"}"
```

Aggiunta di una prenotazione in piscina
```bash
curl -X POST "http://localhost:5001/resources/piscina" -H "Content-Type: application/json" -d "{"cf": "RSSMRA85M01H501Z", "data":"2025-09-11", "lettini":2, "ombrelloni":1}"
```

Eliminazione di una prenotazione di un campo
```bash
curl -X DELETE "http://localhost:5001/resources/campo" -H "Content-Type: application/json" -d "{"cf":"RSSMRA85M01H501Z", "data":"2025-09-20", "ora":"10", "tipologia":"tennis"}"
```

Eliminazione di una prenotazione in piscina
```bash
curl -X DELETE "http://localhost:5001/resources/piscina" -H "Content-Type: application/json" -d "{"cf": "RSSMRA85M01H501Z", "data":"2025-09-11", "lettini":2, "ombrelloni":1}"
```

Visualizzazione degli slot liberi di un campo in una data precisa
```bash
curl -X GET http://localhost:5001/resources/campiliberi/2025-08-20/tennis
```

Visualizzazione di ombrelloni e lettini liberi in una data precisa
```bash
curl -X GET "http://localhost:5001/resources/piscinalibera/2025-09-11"
```

## GRAPHQL con strawberry

STRAWBERRY libreria Python che permette di costruire API GraphQL

TIPO struttura dati utilizzata nella comunicazione client-server  

![](https://github.com/laramartino/esameDEP/blob/main/slides/img/tipoGraphQL.png)

SCHEMA definizione dei tipi e di query e mutazioni



### *member-service*

Richieste all'interfaccia GraphiQL ```http://localhost:5000/graphql```

### *resource-service*

Richieste all'interfaccia GraphiQL ```http://localhost:5001/graphql```
